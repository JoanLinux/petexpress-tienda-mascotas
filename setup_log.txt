+ set -euo pipefail
+ APP_NAME='Casa Beatricita'
+ APP_ID_DEFAULT=com.casabeatricita.app
+ WORKFLOW_PATH=.github/workflows/android-capacitor.yml
+ say 'Verificando raÃ­z del proyectoâ€¦'
+ printf '\n\033[1;96m[INFO]\033[0m %s\n' 'Verificando raÃ­z del proyectoâ€¦'

[1;96m[INFO][0m Verificando raÃ­z del proyectoâ€¦
+ '[' -f package.json ']'
+ '[' -f vite.config.ts ']'
+ say 'Instalando dependencias de Capacitorâ€¦'
+ printf '\n\033[1;96m[INFO]\033[0m %s\n' 'Instalando dependencias de Capacitorâ€¦'

[1;96m[INFO][0m Instalando dependencias de Capacitorâ€¦
+ npm i -D @capacitor/cli
+ npm i @capacitor/core @capacitor/android
+ say 'Asegurando script build en package.jsonâ€¦'
+ printf '\n\033[1;96m[INFO]\033[0m %s\n' 'Asegurando script build en package.jsonâ€¦'

[1;96m[INFO][0m Asegurando script build en package.jsonâ€¦
+ node -
{
  dev: 'vite',
  build: 'vite build',
  'build:dev': 'vite build --mode development',
  lint: 'eslint .',
  preview: 'vite preview'
}
+ say 'Ajustando capacitor.config.tsâ€¦'
+ printf '\n\033[1;96m[INFO]\033[0m %s\n' 'Ajustando capacitor.config.tsâ€¦'

[1;96m[INFO][0m Ajustando capacitor.config.tsâ€¦
+ '[' -f capacitor.config.ts ']'
+ node -
capacitor.config.ts actualizado
+ say 'Build Viteâ€¦'
+ printf '\n\033[1;96m[INFO]\033[0m %s\n' 'Build Viteâ€¦'

[1;96m[INFO][0m Build Viteâ€¦
+ npm ci

added 474 packages, and audited 475 packages in 8s

88 packages are looking for funding
  run `npm fund` for details

3 moderate severity vulnerabilities

Some issues need review, and may require choosing
a different dependency.

Run `npm audit` for details.
+ npm run build

> vite_react_shadcn_ts@0.0.0 build
> vite build

vite v5.4.19 building for production...
transforming...
âœ“ 1848 modules transformed.
rendering chunks...
computing gzip size...
dist/index.html                                  1.18 kB â”‚ gzip:   0.50 kB
dist/assets/salud-icon-BGKol_8S.webp            12.07 kB
dist/assets/comida-gatos-icon-LECf8qsw.webp     16.42 kB
dist/assets/higiene-icon-CTW50Pt8.webp          17.87 kB
dist/assets/comida-perros-icon-Zuioocev.webp    22.52 kB
dist/assets/juguetes-icon-B2dgDnAw.webp         25.20 kB
dist/assets/disfraces-icon-D-Z4xWG7.webp        31.14 kB
dist/assets/accesorios-icon-BbQQFGYg.webp       38.77 kB
dist/assets/default-mexican-dish-Cubh_7b3.jpg  125.83 kB
dist/assets/casa-beatricita-hero-BEa_SQeh.jpg  186.49 kB
dist/assets/index-Ba_oH9L6.css                  83.09 kB â”‚ gzip:  13.51 kB
dist/assets/index-BzCaHLdm.js                  627.85 kB â”‚ gzip: 184.77 kB

(!) Some chunks are larger than 500 kB after minification. Consider:
- Using dynamic import() to code-split the application
- Use build.rollupOptions.output.manualChunks to improve chunking: https://rollupjs.org/configuration-options/#output-manualchunks
- Adjust chunk size limit for this warning via build.chunkSizeWarningLimit.
âœ“ built in 6.64s
+ '[' '!' -d android ']'
+ say 'android/ ya existe.'
+ printf '\n\033[1;96m[INFO]\033[0m %s\n' 'android/ ya existe.'

[1;96m[INFO][0m android/ ya existe.
+ say 'Sync Capacitorâ€¦'
+ printf '\n\033[1;96m[INFO]\033[0m %s\n' 'Sync Capacitorâ€¦'

[1;96m[INFO][0m Sync Capacitorâ€¦
+ npx cap copy android
âœ” Copying web assets from dist to android/app/src/main/assets/public in 31.08ms
âœ” Creating capacitor.config.json in android/app/src/main/assets in 683.92Î¼s
âœ” copy android in 96.25ms
+ npx cap sync android
âœ” Copying web assets from dist to android/app/src/main/assets/public in 25.81ms
âœ” Creating capacitor.config.json in android/app/src/main/assets in 491.53Î¼s
âœ” copy android in 72.14ms
âœ” Updating Android plugins in 12.66ms
âœ” update android in 65.40ms
[info] Sync finished in 0.192s
+ say 'Creando/actualizando workflowâ€¦'
+ printf '\n\033[1;96m[INFO]\033[0m %s\n' 'Creando/actualizando workflowâ€¦'

[1;96m[INFO][0m Creando/actualizando workflowâ€¦
+ mkdir -p .github/workflows
+ cat
+ say 'Git commit & pushâ€¦'
+ printf '\n\033[1;96m[INFO]\033[0m %s\n' 'Git commit & pushâ€¦'

[1;96m[INFO][0m Git commit & pushâ€¦
+ git add capacitor.config.ts package.json android .github/workflows/android-capacitor.yml
+ git commit -m 'chore(android): ensure Capacitor android & CI (Java 21) + sync'
+ git push origin main
To github.com:JoanLinux/petexpress-tienda-mascotas.git
 ! [rejected]        main -> main (fetch first)
error: failed to push some refs to 'git@github.com:JoanLinux/petexpress-tienda-mascotas.git'
hint: Updates were rejected because the remote contains work that you do
hint: not have locally. This is usually caused by another repository pushing
hint: to the same ref. You may want to first integrate the remote changes
hint: (e.g., 'git pull ...') before pushing again.
hint: See the 'Note about fast-forwards' in 'git push --help' for details.
+ warn 'Push no realizado (configura PAT/SSH y repite: git push origin main)'
+ printf '\n\033[1;93m[WARN]\033[0m %s\n' 'Push no realizado (configura PAT/SSH y repite: git push origin main)'

[1;93m[WARN][0m Push no realizado (configura PAT/SSH y repite: git push origin main)
+ say Checks:
+ printf '\n\033[1;96m[INFO]\033[0m %s\n' Checks:

[1;96m[INFO][0m Checks:
+ '[' -d android ']'
+ echo '  âœ” android/ existe'
  âœ” android/ existe
+ '[' -f android/gradlew ']'
+ echo '  âœ” gradlew'
  âœ” gradlew
+ '[' -f android/app/build/outputs/apk/release/app-release.apk ']'
+ echo '  â„¹ Sin APK local (ver Artifact en Actions)'
  â„¹ Sin APK local (ver Artifact en Actions)
